### 描述

请求页面调度即当**进程**在运行中需要访问某部分程序和数据时，若发现其所在的页面不在内存，便立即提出请求，由 OS 将其所需页面调入内存。由请求调页策略所确定调入的页，是一定会被访问的，再加之请求调页策略比较易于实现，故在**虚拟存储器**中大多采用此策略。但这种策略每次仅调入一页，故须花费较大的系统开销，增加了磁盘 I/O 的启动频率。

### 策略

页面调度策略有两种：请求页调入和预先页调入。

#### 请求页调入

请求页调入简称请调，是指在CPU需要访问进程某页面时，发现所访问的页面不在内存中，CPU发出缺页中断信号，请求将该页调入内存。操作系统接收到缺页中断请求后，为之分配物理块并从外存中将该页调入内存。

每个进程在刚开始执行时，所需要的页面很多，会产生多次缺页中断，页面被逐一调入内存。根据程序的局部性原理，当进程运行一段时间后．所需要的页面会逐步减少，缺页中断次数会逐渐下降，最后趋向于很低的水平．进程运行进入相对平稳阶段。

请求页调入策略的优点是只有在需要时才将页面调入内存，节省了内存空间。

请求页调入策略的缺点如下。

(1)在进程初次执行时，开始阶段会有大量的页调入内存，这时的进程切换开销很大。

(2)发生缺页中断时操作系统会调入[页面](https://baike.baidu.com/item/页面)，而每次又仅调入一个页面，启动磁盘作I/O的频率很高。由于每次启动磁盘时会产生一个时间延迟，因此，会造成系统用于I/O的时间增长，系统效率降低。

(3)对于执行顺序跳跃性大的程序，缺页情况变化大，难以趋向稳定的水平，从而引起系统不稳定。

#### 预调页策略

如果进程的许多页是存放在外存的一个连续区域中，则一次调入若干个相邻的页，会比一次调入一页更高效些。但如果调入的一批页面中的大多数都未被访问，则又是低效的。可采用一种以预测为基础的预调页策略，将那些预计在不久之后便会被访问的页面预先调入内存。如果预测较准确，那么，这种策略显然是很有吸引力的。但遗憾的是，预调页的成功率仅约 50%。故这种策略主要用于进程的首次调入时，由程序员指出应该先调入哪些页。 

### 置换策略

当需要从外存调入页到内存时．如果当前内存中没有空闲物理块，则操作系统需要将某些页置换出内存，再将新的页面换入内存。选择被置换出的页有两种策略，全局置换和局部置换。

#### 全局置换

全局置换是指操作系统从所有当前位于内存中的页面中选择一个页面淘汰，释放出对应的物理块，而不是仅从需要该页的进程的物理块换出。这种置换方法会影响大多数进程的运行，是一种动态方法。

#### 局部置换

局部置换是指当某进程有页面需要换入到内存中时，只能从该进程己在内存中的页面中选择一页淘汰。该置换方法对其他进程没有影响。

局部置换与全局置换比较有明显的缺点：如果进程在执行期间所需要的内存物理块数发生变化，页面置换发生频繁，即使系统有空闲的物理块，也不可能增加给该进程，另外，如果系统结某进程分配的物理块数太多，系统不会收回，最终会造成内存空间浪费。 [2] 

### 从何处调入

在请求分页系统中的外存分为两部分：用于存放文件的文件区和用于存放对换页面的对换区。通常，由于对换区是采用连续分配方式，而文件区是采用离散分配方式，故对换区的磁盘 I/O 速度比文件区的高。这样，每当发生缺页请求时，系统应从何处将缺页调入内存，可分成如下三种情况：

1. 系统拥有足够的对换区空间，这时可以全部从对换区调入所需页面，以提高调页速度。为此，在进程运行前，便须将与该进程有关的文件从文件区拷贝到对换区。
2. 系统缺少足够的对换区空间，这时凡是不会被修改的文件都直接从文件区调入；而当换出这些页面时，由于它们未被修改而不必再将它们换出，以后再调入时，仍从文件区直接调入。但对于那些可能被修改的部分，在将它们换出时，便须调到对换区，以后需要时，再从对换区调入。
3. UNIX 方式。由于与进程有关的文件都放在文件区，故凡是未运行过的页面，都应从文件区调入。而对于曾经运行过但又被换出的页面，由于是被放在对换区，因此在下次调入时，应从对换区调入。由于 UNIX 系统允许页面共享，因此，某进程所请求的页面有可能已被其它进程调入内存，此时也就无须再从对换区调入。

### 页面调入过程

每当程序所要访问的页面未在内存时，便向 CPU 发出一缺页中断，中断处理程序首先保留 CPU 环境，分析中断原因后转入缺页中断处理程序。该程序通过查找页表，得到该页在外存的物理块后，如果此时内存能容纳新页，则启动磁盘I/O 将所缺之页调入内存，然后修改页表。如果内存已满，则须先按照某种置换算法从内存中选出一页准备换出；如果该页未被修改过，可不必将该页写回磁盘；但如果此页已被修改，则必须将它写回磁盘，然后再把所缺的页调入内存，并修改页表中的相应表项，置其存在位为“1” ，并将此页表项写入快表中。在缺页调入内存后，利用修改后的页表，去形成所要访问数据的物理地址，再去访问内存数据。整个页面的调入过程对用户是透明的。

### 存储管理方式

在存储器管理中，连续分配方式会形成许多“碎片”，虽然可通过“紧凑”方法将许多碎片拼接成可用的大块空间，但须为之付出很大开销。

如果允许将一个进程直接分散地装入到许多不相邻的分区中，则无须再进行“紧凑”。基于这一思想而产生了离散分配方式。如果离散分配的基本单位是页，则称为分页存储管理方式。在分页存储管理方式中，如果不具备页面对换功能，则称为基本分页存储管理方式，或称为纯分页存储管理方式，它不具有支持实现虚拟存储器的功能，它要求把每个作业全部装入内存后方能运行。

分页存储管理的基本原理是：将主存空间和辅存空间分别等分为大小相等的若干页，页的大小为个字节，如（1KB），（2KB），（4KB）等，并且为每个页按顺序指定一个页号，即0页、1页、2页、…。为了叙述方便，把主存的页（物理页或绝对页）称为页面。例如，若主存空间为8KB，辅存空间为16KB，页的大小为1KB，则主存空间可分为8个页面，其页面号为0～7；辅存空间可分为16个页，其页号为0～15。当程序运行时，以“页”为单位进行地址映射，即操作系统以页为单位把逻辑页从辅存调入主存，存放在物理页面上，供CPU执行。在分页存储管理机制中，把逻辑页对应的逻辑地址称为线性地址。